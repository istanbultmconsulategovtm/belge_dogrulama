<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belge Doğrulama Sistemi</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SheetJS (XLSX) for Excel parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --secondary: #4285f4;
            --success: #34a853;
            --danger: #ea4335;
            --dark-text: #202124;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: var(--dark-text);
        }
        
        .card {
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border: none;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            padding: 10px 20px;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary);
            border-color: var(--secondary);
        }
        
        .navbar {
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }
        
        .hero-section {
            background: linear-gradient(135deg, #1a73e8, #4285f4);
            color: white;
            border-radius: 0 0 30px 30px;
            padding: 80px 0;
            margin-bottom: 40px;
        }
        
        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 28px;
        }
        
        .form-container {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .result-card {
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 18px;
        }
        
        .success-result {
            background-color: rgba(52, 168, 83, 0.1);
            border-left: 4px solid var(--success);
        }
        
        .error-result {
            background-color: rgba(234, 67, 53, 0.1);
            border-left: 4px solid var(--danger);
        }
        
        .admin-panel {
            background-color: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }
        
        footer {
            background: linear-gradient(135deg, #1a73e8, #4285f4);
            color: white;
            padding: 30px 0;
            margin-top: 60px;
        }
        
        .login-container {
            max-width: 500px;
            margin: 50px auto;
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="javascript:void(0)" onclick="showHome()">
                <i class="fas fa-file-contract me-2"></i>
                <span class="fw-bold">BELGE DOĞRULAMA</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="javascript:void(0)" onclick="showHome()">Ana Sayfa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)" onclick="showVerification()">Belge Doğrula</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)" onclick="showAdminLogin()">Yönetici Girişi</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)" onclick="showContact()">İletişim</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section" id="home-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-4">Belge Doğrulama Sistemi</h1>
            <p class="lead mb-5">Belgelerinizi kolay, hızlı ve güvenli bir şekilde doğrulayın</p>
            <div class="d-flex justify-content-center gap-3">
                <button class="btn btn-light btn-lg px-4 py-2 fw-bold" onclick="showVerification()">
                    <i class="fas fa-check-circle me-2"></i>Belge Doğrula
                </button>
                <button class="btn btn-outline-light btn-lg px-4 py-2" onclick="showAdminLogin()">
                    <i class="fas fa-user-shield me-2"></i>Yönetici Girişi
                </button>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="container mb-5" id="features-section">
        <div class="row text-center mb-4">
            <div class="col-md-8 mx-auto">
                <h2 class="fw-bold mb-3">Neden Bizim Sistemimizi Kullanmalısınız?</h2>
                <p class="lead text-muted">Belgelerinizin güvenliğini ve geçerliliğini sağlamak için tasarlanmış kapsamlı çözüm</p>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="h5 fw-bold">Güvenli Doğrulama</h3>
                    <p class="text-muted">Gelişmiş güvenlik protokolleri ile belgeleriniz tam koruma altında.</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3 class="h5 fw-bold">Hızlı Sonuç</h3>
                    <p class="text-muted">Saniyeler içinde belgelerinizin geçerliliğini doğrulayın.</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3 class="h5 fw-bold">Geniş Veritabanı</h3>
                    <p class="text-muted">Binlerce kayıt ile kapsamlı doğrulama imkanı.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Verification Section -->
    <section class="container mb-5 d-none" id="verification-section">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="form-container">
                    <h2 class="text-center mb-4 fw-bold">Belge Doğrulama</h2>
                    <p class="text-center text-muted mb-4">Belge bilgilerinizi aşağıdaki formu doldurarak doğrulayabilirsiniz</p>
                    
                    <form id="verification-form">
                        <div class="mb-3">
                            <label for="document-number" class="form-label fw-bold">Belge Numarası</label>
                            <input type="text" class="form-control form-control-lg" id="document-number" placeholder="Belge numaranızı girin" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="document-date" class="form-label fw-bold">Belge Tarihi</label>
                            <input type="text" class="form-control form-control-lg" id="document-date" placeholder="GG/AA/YYYY formatında girin" required>
                            <div class="form-text">Örnek: 15/07/2023</div>
                        </div>
                        
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-search me-2"></i>Belgeyi Doğrula
                            </button>
                        </div>
                    </form>
                    
                    <div class="result-card mt-4 p-4 d-none" id="result-container">
                        <div id="verification-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Login Section -->
    <section class="container mb-5 d-none" id="admin-login-section">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="login-container">
                    <h2 class="text-center mb-4 fw-bold">Yönetici Girişi</h2>
                    <p class="text-center text-muted mb-4">Yönetici paneline erişmek için lütfen giriş yapın</p>
                    
                    <form id="admin-login-form">
                        <div class="mb-3">
                            <label for="admin-username" class="form-label fw-bold">Kullanıcı Adı</label>
                            <input type="text" class="form-control form-control-lg" id="admin-username" placeholder="Kullanıcı adınızı girin" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="admin-password" class="form-label fw-bold">Parola</label>
                            <input type="password" class="form-control form-control-lg" id="admin-password" placeholder="Parolanızı girin" required>
                        </div>
                        
                        <div class="d-grid mb-3">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-sign-in-alt me-2"></i>Giriş Yap
                            </button>
                        </div>
                        
                        <div class="alert alert-danger d-none" id="login-error"></div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Panel Section -->
    <section class="container mb-5 d-none" id="admin-panel-section">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold">Yönetici Paneli</h2>
            <button class="btn btn-outline-primary" onclick="logoutAdmin()">
                <i class="fas fa-sign-out-alt me-2"></i>Çıkış Yap
            </button>
        </div>
        
        <div class="admin-panel">
            <!-- Birinci satır: Veri Görüntüle / Excel İçe Aktar / Dışa Aktar -->
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-database display-4 text-primary mb-3"></i>
                            <h3 class="card-title">Veritabanı Yönetimi</h3>
                            <p class="card-text">Veritabanı kayıtlarını görüntüleyin ve yönetin</p>
                            <button class="btn btn-primary mt-2" onclick="showDatabase()">Görüntüle</button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-file-excel display-4 text-success mb-3"></i>
                            <h3 class="card-title">Excel'den İçe Aktar</h3>
                            <p class="card-text">Excel dosyalarından toplu kayıt ekleyin</p>
                            <button class="btn btn-success mt-2" onclick="importFromExcel()">İçe Aktar</button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-file-export display-4 text-info mb-3"></i>
                            <h3 class="card-title">Verileri Dışa Aktar</h3>
                            <p class="card-text">Veritabanını CSV formatında dışa aktarın</p>
                            <button class="btn btn-info mt-2" onclick="exportDatabase()">Dışa Aktar</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- İkinci satır: Veri Sil / Verileri Temizle -->
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-trash-alt display-4 text-danger mb-3"></i>
                            <h3 class="card-title">Veri Sil</h3>
                            <p class="card-text">Belge No ve Tarih bazında kaydı silin</p>
                            <button class="btn btn-danger mt-2" onclick="deleteRecord()">Veri Sil</button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-trash display-4 text-danger mb-3"></i>
                            <h3 class="card-title">Verileri Temizle</h3>
                            <p class="card-text">Tüm kayıtları silin</p>
                            <button class="btn btn-danger mt-2" onclick="clearAllData()">Temizle</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Veritabanı Kayıtları Tablosu -->
        <div class="mt-5 d-none" id="database-section">
            <h3 class="fw-bold mb-4">Veritabanı Kayıtları</h3>
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-primary">
                        <tr>
                            <th>Belge No</th>
                            <th>Tarih</th>
                            <th>Soyadı Adı</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody id="database-table">
                        <!-- Kayıtlar buraya yüklenecek -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="container mb-5 d-none" id="contact-section">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="form-container">
                    <h2 class="text-center mb-4 fw-bold">İletişim</h2>
                    <p class="text-center text-muted mb-4">Sorularınız veya destek talepleriniz için bize ulaşın</p>
                    
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-envelope fa-2x text-primary mb-3"></i>
                                    <h5 class="card-title">E-posta</h5>
                                    <p class="card-text">stambulconstm2@gmail.com</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-phone fa-2x text-success mb-3"></i>
                                    <h5 class="card-title">Telefon</h5>
                                    <p class="card-text">+90 (212) 662 02 21/22/23</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <form>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Adınız</label>
                            <input type="text" class="form-control form-control-lg" placeholder="Adınızı girin" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">E-posta</label>
                            <input type="email" class="form-control form-control-lg" placeholder="E-posta adresinizi girin" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Mesajınız</label>
                            <textarea class="form-control form-control-lg" rows="4" placeholder="Mesajınızı yazın" required></textarea>
                        </div>
                        
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">Gönder</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5 class="fw-bold mb-3">BELGE DOĞRULAMA</h5>
                    <p>Güvenilir belge doğrulama çözümleri sunan lider platform.</p>
                </div>
                
                <div class="col-md-4 mb-4">
                    <h5 class="fw-bold mb-3">HIZLI LİNKLER</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="javascript:void(0)" class="text-white text-decoration-none" onclick="showHome()">Ana Sayfa</a></li>
                        <li class="mb-2"><a href="javascript:void(0)" class="text-white text-decoration-none" onclick="showVerification()">Belge Doğrula</a></li>
                        <li class="mb-2"><a href="javascript:void(0)" class="text-white text-decoration-none" onclick="showContact()">İletişim</a></li>
                        <li><a href="javascript:void(0)" class="text-white text-decoration-none" onclick="showAdminLogin()">Yönetici Girişi</a></li>
                    </ul>
                </div>
                
                <div class="col-md-4 mb-4">
                    <h5 class="fw-bold mb-3">BİZİ TAKİP EDİN</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="fab fa-facebook fa-2x"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-twitter fa-2x"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-instagram fa-2x"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-linkedin fa-2x"></i></a>
                    </div>
                </div>
            </div>
            
            <hr class="bg-light">
            
            <div class="text-center pt-3">
                <p class="mb-0">© 2023 Belge Doğrulama Sistemi. Tüm hakları saklıdır.</p>
            </div>
        </div>
    </footer>

    <!-- Bootstrap + Custom JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Başlangıçta boş veritabanı
        let database = [];

        document.addEventListener('DOMContentLoaded', function() {
            // Form event listener'ları
            const verificationForm = document.getElementById('verification-form');
            if (verificationForm) {
                verificationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    verifyDocument();
                });
            }

            const adminLoginForm = document.getElementById('admin-login-form');
            if (adminLoginForm) {
                adminLoginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    loginAdmin();
                });
            }

            // İlk açılışta Ana Sayfa
            showHome();
        });

        // Bölümleri gizleme/gösterme fonksiyonları
        function hideAllSections() {
            const sections = [
                'home-section',
                'features-section',
                'verification-section',
                'admin-login-section',
                'admin-panel-section',
                'contact-section'
            ];
            sections.forEach(id => {
                const sec = document.getElementById(id);
                if (sec) sec.classList.add('d-none');
            });
        }

        function showHome() {
            hideAllSections();
            const home = document.getElementById('home-section');
            const features = document.getElementById('features-section');
            if (home) home.classList.remove('d-none');
            if (features) features.classList.remove('d-none');
        }

        function showVerification() {
            hideAllSections();
            const verif = document.getElementById('verification-section');
            if (verif) {
                verif.classList.remove('d-none');
                resetVerificationForm();
            }
        }

        function showAdminLogin() {
            hideAllSections();
            const adminLogin = document.getElementById('admin-login-section');
            const loginError = document.getElementById('login-error');
            if (adminLogin) adminLogin.classList.remove('d-none');
            if (loginError) loginError.classList.add('d-none');
        }

        function showAdminPanel() {
            hideAllSections();
            const adminPanel = document.getElementById('admin-panel-section');
            const dbSection = document.getElementById('database-section');
            if (adminPanel) adminPanel.classList.remove('d-none');
            if (dbSection) dbSection.classList.add('d-none');
        }

        function showContact() {
            hideAllSections();
            const contact = document.getElementById('contact-section');
            if (contact) contact.classList.remove('d-none');
        }

        function resetVerificationForm() {
            const numInput = document.getElementById('document-number');
            const dateInput = document.getElementById('document-date');
            const resultContainer = document.getElementById('result-container');
            if (numInput) numInput.value = '';
            if (dateInput) dateInput.value = '';
            if (resultContainer) resultContainer.classList.add('d-none');
        }

        // Belge Doğrulama (GG/AA/YYYY formatına göre kontrol)
        function verifyDocument() {
            const docNumber = document.getElementById('document-number').value.trim();
            const docDate = document.getElementById('document-date').value.trim();
            const resultContainer = document.getElementById('result-container');
            const resultElement = document.getElementById('verification-result');

            if (!resultContainer || !resultElement) return;

            resultContainer.classList.remove('success-result', 'error-result');
            resultContainer.classList.remove('d-none');

            if (!docNumber || !docDate) {
                resultContainer.classList.add('error-result');
                resultElement.innerHTML = `
                    <h3 class="text-danger"><i class="fas fa-exclamation-circle me-2"></i>Hata!</h3>
                    <p>Lütfen belge numarası ve tarih bilgilerini giriniz.</p>
                `;
                return;
            }

            const doc = database.find(item =>
                item.id.toString() === docNumber && item.date === docDate
            );

            if (doc && doc.valid) {
                resultContainer.classList.add('success-result');
                resultElement.innerHTML = `
                    <div class="text-success mb-3">
                        <i class="fas fa-check-circle fa-3x"></i>
                    </div>
                    <h3 class="text-success">BELGE DOĞRULANDI</h3>
                    <p><strong>Belge No:</strong> ${doc.id}</p>
                    <p><strong>Tarih:</strong> ${doc.date}</p>
                    <p><strong>Soyadı Adı:</strong> ${doc.name}</p>
                    <p class="mt-3">Bu belge sistemimizde kayıtlıdır ve geçerlidir.</p>
                `;
            } else {
                resultContainer.classList.add('error-result');
                resultElement.innerHTML = `
                    <div class="text-danger mb-3">
                        <i class="fas fa-times-circle fa-3x"></i>
                    </div>
                    <h3 class="text-danger">BELGE BULUNAMADI</h3>
                    <p><strong>Girilen Bilgiler:</strong></p>
                    <p>Belge No: ${docNumber}</p>
                    <p>Tarih: ${docDate}</p>
                    <p class="mt-3">Lütfen bilgilerinizi kontrol edip tekrar deneyiniz. Eğer sorun devam ederse yetkililerle iletişime geçin.</p>
                `;
            }
        }

        // Yönetici Girişi
        function loginAdmin() {
            const username = document.getElementById('admin-username').value.trim();
            const password = document.getElementById('admin-password').value.trim();
            const errorElement = document.getElementById('login-error');

            if (!errorElement) return;

            if (username === "tkmstamb" && password === "turstm1!stamtkm852496+") {
                showAdminPanel();
            } else {
                errorElement.textContent = "Geçersiz kullanıcı adı veya parola!";
                errorElement.classList.remove('d-none');
            }
        }

        function logoutAdmin() {
            const userInput = document.getElementById('admin-username');
            const passInput = document.getElementById('admin-password');
            if (userInput) userInput.value = '';
            if (passInput) passInput.value = '';
            showAdminLogin();
        }

        // Admin Panel: Veritabanı Görüntüle
        function showDatabase() {
            const tableBody = document.getElementById('database-table');
            if (!tableBody) return;

            tableBody.innerHTML = '';
            database.forEach(doc => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${doc.id}</td>
                    <td>${doc.date}</td>
                    <td>${doc.name}</td>
                    <td>
                        <span class="badge ${doc.valid ? 'bg-success' : 'bg-danger'}">
                            ${doc.valid ? 'Geçerli' : 'Geçersiz'}
                        </span>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            const dbSection = document.getElementById('database-section');
            if (dbSection) dbSection.classList.remove('d-none');
        }

        // Excel'den içe aktarma (SheetJS ile)
        function importFromExcel() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.xlsx, .xls';
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = function(evt) {
                    const data = new Uint8Array(evt.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { defval: "" });
                    let addedCount = 0;
                    jsonData.forEach(rowObj => {
                        if (
                            rowObj.hasOwnProperty('id') &&
                            rowObj.hasOwnProperty('date') &&
                            rowObj.hasOwnProperty('name') &&
                            rowObj.hasOwnProperty('valid')
                        ) {
                            const idVal = parseInt(rowObj.id);
                            const dateVal = rowObj.date.toString();
                            const nameVal = rowObj.name.toString();
                            const validVal = String(rowObj.valid).toLowerCase() === 'true';

                            const exists = database.some(d => d.id === idVal && d.date === dateVal);
                            if (!exists) {
                                database.push({
                                    id: idVal,
                                    date: dateVal,
                                    name: nameVal,
                                    valid: validVal
                                });
                                addedCount++;
                            }
                        }
                    });

                    if (addedCount > 0) {
                        alert(`Excel dosyasından ${addedCount} yeni kayıt başarıyla aktarıldı!`);
                    } else {
                        alert("Excel dosyasından aktarmaya uygun yeni veri bulunamadı veya zaten ekli.");
                    }
                };
                reader.onerror = function(err) {
                    alert("Excel dosyası okunurken hata oluştu:\n" + err);
                };
                reader.readAsArrayBuffer(file);
            };
            input.click();
        }

        // CSV şeklinde dışa aktarma
        function exportDatabase() {
            const headers = ['id', 'date', 'name', 'valid'];
            const rows = database.map(d => [d.id, d.date, d.name, d.valid]);
            let csvContent = headers.join(',') + '\n';
            rows.forEach(r => {
                csvContent += r.join(',') + '\n';
            });
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", "veritabani.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Tek bir kaydı silmek için: ID ve Tarih sor, eşleşeni kaldır
        function deleteRecord() {
            const idStr = prompt("Silinecek kaydın Belge Numarasını girin:");
            if (idStr === null) return; 
            const dateStr = prompt("Silinecek kaydın Tarihini (GG/AA/YYYY formatında) girin:");
            if (dateStr === null) return;

            const idVal = parseInt(idStr.trim());
            const dateVal = dateStr.trim();
            const index = database.findIndex(d => d.id === idVal && d.date === dateVal);
            if (index !== -1) {
                database.splice(index, 1);
                alert(`Belge No: ${idVal}, Tarih: ${dateVal} kaydı başarıyla silindi.`);
            } else {
                alert("Eşleşen kayıt bulunamadı. Lütfen bilgileri kontrol edip tekrar deneyin.");
            }
        }

        // Tüm verileri temizleme (array’i boşalt)
        function clearAllData() {
            const confirmDelete = confirm("Tüm kayıtları silmek istediğinizden emin misiniz?");
            if (!confirmDelete) return;
            database = [];
            alert("Tüm veriler başarıyla temizlendi.");
        }
    </script>
</body>
</html>
